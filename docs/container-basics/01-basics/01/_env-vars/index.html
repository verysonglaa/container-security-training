<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=../../../../../favicons/favicon.ico><link rel=apple-touch-icon href=../../../../../favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=../../../../../favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=../../../../../favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../../../../favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=../../../../../favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=../../../../../favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=../../../../../favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=../../../../../favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=../../../../../favicons/android-192x192.png sizes=192x192><title>1.2 Environment variables | Container Security Training</title>
<meta name=description content="Environment variables So why was there an error in the previous lab? The MariaDB server is not able to run without a proper configuration. Docker can pass variables into the instantiation process via environment variables. Environment variables are passed via the parameter -e, e.g.:
docker run -it -e MARIADB_ROOT_PASSWORD=my-secret-pw mariadb Once you run the command you will see an output like this:
Initializing database PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !"><meta property="og:title" content="1.2 Environment variables"><meta property="og:description" content="Environment variables So why was there an error in the previous lab? The MariaDB server is not able to run without a proper configuration. Docker can pass variables into the instantiation process via environment variables. Environment variables are passed via the parameter -e, e.g.:
docker run -it -e MARIADB_ROOT_PASSWORD=my-secret-pw mariadb Once you run the command you will see an output like this:
Initializing database PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !"><meta property="og:type" content="article"><meta property="og:url" content="/docs/container-basics/01-basics/01/_env-vars/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-10-22T18:00:35+02:00"><meta itemprop=name content="1.2 Environment variables"><meta itemprop=description content="Environment variables So why was there an error in the previous lab? The MariaDB server is not able to run without a proper configuration. Docker can pass variables into the instantiation process via environment variables. Environment variables are passed via the parameter -e, e.g.:
docker run -it -e MARIADB_ROOT_PASSWORD=my-secret-pw mariadb Once you run the command you will see an output like this:
Initializing database PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !"><meta itemprop=dateModified content="2024-10-22T18:00:35+02:00"><meta itemprop=wordCount content="1235"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="1.2 Environment variables"><meta name=twitter:description content="Environment variables So why was there an error in the previous lab? The MariaDB server is not able to run without a proper configuration. Docker can pass variables into the instantiation process via environment variables. Environment variables are passed via the parameter -e, e.g.:
docker run -it -e MARIADB_ROOT_PASSWORD=my-secret-pw mariadb Once you run the command you will see an output like this:
Initializing database PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !"><link rel=preload href=../../../../../scss/main.min.adaeead791a8f109b4559b249a7a020bb877ffc11fefeb15be29f9b5a0346557.css as=style><link href=../../../../../scss/main.min.adaeead791a8f109b4559b249a7a020bb877ffc11fefeb15be29f9b5a0346557.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=../../../../../><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Container Security Training</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class=nav-link href=../../../../../setup/><span>Setup</span></a></li><li class=nav-item><a class="nav-link active" href=../../../../../docs/><span>Labs</span></a></li><li class=nav-item><a class=nav-link href=../../../../../slides/><span>Slides</span></a></li><li class=nav-item><a class=nav-link href=https://www.songlaa.com target=_blank rel=noopener><span>songlaa gmbh</span></a></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=../../../../../offline-search-index.af4d21e7335b63483faff699ba802efb.json data-offline-search-base-href=../../../../../ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=../../../../../offline-search-index.af4d21e7335b63483faff699ba802efb.json data-offline-search-base-href=../../../../../ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=../../../../../docs/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Labs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docscontainer-basics01-basics-li><a href=../../../../../docs/container-basics/01-basics/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docscontainer-basics01-basics><span>1. 1. Docker Basics</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics01-basics01_images-li><a href=../../../../../docs/container-basics/01-basics/01/_images/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_images><span>1.1. 1.1 Images</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docscontainer-basics01-basics01_env-vars-li><a href=../../../../../docs/container-basics/01-basics/01/_env-vars/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_env-vars><span class=td-sidebar-nav-active-item>1.2. 1.2 Environment variables</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics01-basics01_frontend-li><a href=../../../../../docs/container-basics/01-basics/01/_frontend/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_frontend><span>1.3. 1.3 Frontend</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics01-basics01_dockerfile-li><a href=../../../../../docs/container-basics/01-basics/01/_dockerfile/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_dockerfile><span>1.4. 1.4 Dockerfile</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics01-basics01_dockerfile_ms-li><a href=../../../../../docs/container-basics/01-basics/01/_dockerfile_ms/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_dockerfile_ms><span>1.5. 1.5 MultiStage Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics01-basics01_deepdive-li><a href=../../../../../docs/container-basics/01-basics/01/_deepdive/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics01-basics01_deepdive><span>1.6. 1.6 Under the hood</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docscontainer-basics02-security-li><a href=../../../../../docs/container-basics/02-security/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docscontainer-basics02-security><span>2. 2. Securing Containers</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_ssdlc-li><a href=../../../../../docs/container-basics/02-security/02/_ssdlc/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_ssdlc><span>2.1. 2.1 SSDLC</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_root-li><a href=../../../../../docs/container-basics/02-security/02/_root/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_root><span>2.2. 2.2 Avoid Root</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_capabilities-li><a href=../../../../../docs/container-basics/02-security/02/_capabilities/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_capabilities><span>2.3. 2.3 Capabilities</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_volumes-li><a href=../../../../../docs/container-basics/02-security/02/_volumes/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_volumes><span>2.4. 2.4 Volume security</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_lsm-li><a href=../../../../../docs/container-basics/02-security/02/_lsm/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_lsm><span>2.5. 2.6 Linux Security Modules</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_privileged-mode-li><a href=../../../../../docs/container-basics/02-security/02/_privileged-mode/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_privileged-mode><span>2.6. 2.7 Privileged Containers</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docscontainer-basics02-security02_runtime_sec-li><a href=../../../../../docs/container-basics/02-security/02/_runtime_sec/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docscontainer-basics02-security02_runtime_sec><span>2.7. 2.8 Container Runtime Security</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"><a href=https://github.com/verysonglaa/k8s-security-training-website/tree/main/content/en/docs/container-basics/01-Basics/01/_env-vars.md class="td-page-meta--view td-page-meta__view" target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/verysonglaa/k8s-security-training-website/edit/main/content/en/docs/container-basics/01-Basics/01/_env-vars.md class="td-page-meta--edit td-page-meta__edit" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/verysonglaa/k8s-security-training-website/new/main/content/en/docs/container-basics/01-Basics/01?filename=change-me.md&amp;value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class="td-page-meta--child td-page-meta__child" target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/verysonglaa/k8s-security-training-website/issues/new?title=1.2%20Environment%20variables" class="td-page-meta--issue td-page-meta__issue" target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#environment-variables>Environment variables</a></li><li><a href=#access-the-container>Access the container</a></li><li><a href=#detached-containers>Detached containers</a></li><li><a href=#mounting-a-volume-in-a-container>Mounting a volume in a container</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=../../../../../docs/>Labs</a></li><li class=breadcrumb-item><a href=../../../../../docs/container-basics/01-basics/>1. Docker Basics</a></li><li class="breadcrumb-item active" aria-current=page>1.2 Environment variables</li></ol></nav><div class=td-content><h1>1.2. 1.2 Environment variables</h1><header class=article-meta></header><h2 id=environment-variables>Environment variables</h2><p>So why was there an error in the previous lab?
The MariaDB server is not able to run without a proper configuration. Docker can pass variables into the instantiation process via environment variables.
Environment variables are passed via the parameter <code>-e</code>, e.g.:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it -e <span style=color:#000>MARIADB_ROOT_PASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span>my-secret-pw mariadb
</span></span></code></pre></div><p>Once you run the command you will see an output like this:</p><pre tabindex=0><code>
Initializing database

PLEASE REMEMBER TO SET A PASSWORD FOR THE MariaDB root USER !
To do so, start the server, then issue the following commands:

&#39;/usr/bin/mysqladmin&#39; -u root password &#39;new-password&#39;
&#39;/usr/bin/mysqladmin&#39; -u root -h  password &#39;new-password&#39;

Alternatively you can run:
&#39;/usr/bin/mysql_secure_installation&#39;

which will also give you the option of removing the test
databases and anonymous user created by default.  This is
strongly recommended for production servers.

See the MariaDB Knowledgebase at http://mariadb.com/kb or the
MySQL manual for more instructions.

Please report any problems at http://mariadb.org/jira

The latest information about MariaDB is available at http://mariadb.org/.
You can find additional information about the MySQL part at:
http://dev.mysql.com
Consider joining MariaDB&#39;s strong and vibrant community:
https://mariadb.org/get-involved/

Database initialized
MySQL init process in progress...
2020-05-27  6:21:03 0 [Note] mysqld (mysqld 10.3.7-MariaDB-1:10.3.7+maria~jessie) starting as process 101 ...
2020-05-27  6:21:03 0 [Note] InnoDB: Using Linux native AIO
2020-05-27  6:21:03 0 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins
2020-05-27  6:21:03 0 [Note] InnoDB: Uses event mutexes
2020-05-27  6:21:03 0 [Note] InnoDB: Compressed tables use zlib 1.2.8
2020-05-27  6:21:03 0 [Note] InnoDB: Number of pools: 1
2020-05-27  6:21:03 0 [Note] InnoDB: Using SSE2 crc32 instructions
2020-05-27  6:21:03 0 [Note] InnoDB: Initializing buffer pool, total size = 256M, instances = 1, chunk size = 128M

...

2020-05-27  6:21:08 0 [Note] mysqld: ready for connections.
Version: &#39;10.3.7-MariaDB-1:10.3.7+maria~jessie&#39;  socket: &#39;/var/run/mysqld/mysqld.sock&#39;  port: 3306  mariadb.org binary distribution
</code></pre><p>If you re-read the command above you will notify that we used the arguments <code>-it</code> (interactive/terminal). And you might have also found out that mariadb does not react to the usual <code>CTRL-c</code>.
So how do we exit this terminal? Docker has an escape sequence to detach from a container and leave it running. For this you have to press <code>CTRL-p</code> and then <code>CTRL-q</code> in bash. In the webshell the shortcuts <code>CTRL-p</code> and <code>CTRL-q</code> are not working. Simply close the terminal and open a new one as a workaround.</p><p>This will leave the container running while you are back in your shell. To verify that the container is running use the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps
</span></span></code></pre></div><p>The output should look much like this:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
</span></span><span style=display:flex><span>7cb31f821233        mariadb             <span style=color:#4e9a06>&#34;docker-entrypoint...&#34;</span>   <span style=color:#0000cf;font-weight:700>5</span> minutes ago       Up <span style=color:#0000cf;font-weight:700>5</span> minutes        3306/tcp            upbeat_blackwell
</span></span></code></pre></div><h2 id=access-the-container>Access the container</h2><p>To connect to the container again you can use the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker <span style=color:#204a87>exec</span> -it &lt;container&gt; bash
</span></span></code></pre></div><p>Where <code>&lt;container></code> can refer to the <code>CONTAINER ID</code> (the first two characters are normally sufficient) or one of the <code>NAMES</code> from the output of <code>docker ps</code>.
In the above output this would be <code>7cb31f821233</code> or <code>upbeat_blackwell</code>.</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>The docker exec command needs either the ID or NAME of the container. Additionally, at the end, an executable.</div><p>In this example, it&rsquo;s <code>bash</code> as we want to do something interactively in the container.</p><p>Once the command is executed you should see this:</p><p><code>root@7cb31f821233:/#</code></p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Every time you connect yourself to a container you will always be the user that was defined in the Dockerfile.</div><p>Now that we are connected, let&rsquo;s find out if the MariaDB is working&mldr;</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mariadb -uroot -pmy-secret-pw
</span></span></code></pre></div><p>If everything works as expected, you should now see the MariaDB command line:</p><pre tabindex=0><code>Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 8
Server version: 10.3.8-MariaDB-1:10.3.8+maria~jessie mariadb.org binary distribution

Copyright (c) 2000, 2020, Oracle, MariaDB Corporation Ab and others.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

MariaDB [(none)]&gt;
</code></pre><p>Type</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>exit<span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><p>to leave the mysql client. Type</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>exit</span>
</span></span></code></pre></div><p>one more time to leave the container.</p><h2 id=detached-containers>Detached containers</h2><p>One might think: <em>This whole starting process is a bit cumbersome with <code>CTRL-p</code> and then <code>CTRL-q</code></em>.
Therefore, you can run a Docker container directly with <code>-d</code> (detached) mode, e.g.:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it -e <span style=color:#000>MARIADB_ROOT_PASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span>my-secret-pw -d mariadb
</span></span></code></pre></div><p>Instead of the output of the container itself, you will now only get the ID of the started container.
If you have a look into the container list, you should see two running containers:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
</span></span><span style=display:flex><span>699e82ed8f1f        mariadb             <span style=color:#4e9a06>&#34;docker-entrypoint...&#34;</span>   <span style=color:#0000cf;font-weight:700>3</span> minutes ago       Up <span style=color:#0000cf;font-weight:700>3</span> minutes        3306/tcp            jolly_bardeen
</span></span><span style=display:flex><span>7cb31f821233        mariadb             <span style=color:#4e9a06>&#34;docker-entrypoint...&#34;</span>   <span style=color:#0000cf;font-weight:700>32</span> minutes ago      Up <span style=color:#0000cf;font-weight:700>32</span> minutes       3306/tcp            upbeat_blackwell
</span></span></code></pre></div><p>We don&rsquo;t need both of them running. To stop a container use the command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker stop &lt;container&gt;
</span></span></code></pre></div><p>After that, check the new state with</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps
</span></span></code></pre></div><p>This should show only one container running:</p><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
699e82ed8f1f        mariadb             &#34;docker-entrypoint...&#34;   9 minutes ago       Up 9 minutes        3306/tcp            jolly_bardeen
</code></pre><p>We just exited the container &ldquo;gracefully&rdquo;, but as an alternative you can also kill a container with the <code>docker kill &lt;container></code> command. This stops the container immediately by using the KILL signal.</p><p>You may recognize that the container <em>upbeat_blackwell</em> is not present in the container list anymore. That is because <code>docker ps</code> only shows running containers, but as always you have a parameter that helps:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps --all
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                         PORTS               NAMES
699e82ed8f1f        mariadb             &#34;docker-entrypoint...&#34;   12 minutes ago      Up 12 minutes                  3306/tcp            jolly_bardeen
7cb31f821233        mariadb             &#34;docker-entrypoint...&#34;   41 minutes ago      Exited (0) 2 minutes ago                           upbeat_blackwell
67d79f95c712        hello-world         &#34;/hello&#34;                 About an hour ago   Exited (0) About an hour ago                       upbeat_boyd
</code></pre><p>Now that the <em>upbeat_blackwell</em> container is stopped delete it:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker rm &lt;container&gt;
</span></span></code></pre></div><p>Now the container has disappeared from the list:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps --all
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                         PORTS               NAMES
</span></span><span style=display:flex><span>699e82ed8f1f        mariadb             <span style=color:#4e9a06>&#34;docker-entrypoint...&#34;</span>   <span style=color:#0000cf;font-weight:700>13</span> minutes ago      Up <span style=color:#0000cf;font-weight:700>13</span> minutes                  3306/tcp            jolly_bardeen
</span></span><span style=display:flex><span>67d79f95c712        hello-world         <span style=color:#4e9a06>&#34;/hello&#34;</span>                 About an hour ago   Exited <span style=color:#ce5c00;font-weight:700>(</span>0<span style=color:#ce5c00;font-weight:700>)</span> About an hour ago                       upbeat_boyd
</span></span></code></pre></div><p>It is a good idea to delete unused containers to save disk space and remove the data wich resides in the read/write layer of the container. So please delete the hello-word container too:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker rm &lt;container&gt;
</span></span></code></pre></div><h2 id=mounting-a-volume-in-a-container>Mounting a volume in a container</h2><details><summary>🤔 I have a container with a database server running. What happens to my data when I remove the container?</summary><p>It&rsquo;s gone. The docker instance has no persistence layer to store data permanently, let us address that problem in this chapter.</p></details><p>The MariaDB container is a good example as to why it&rsquo;s good to have an external volume.
There are several possibilities on how to work with volumes in Docker, in this case, we&rsquo;re going to create a docker volume to store the persistent data of our MariaDB. The volume is managed by Docker itself.</p><p>Create the docker-managed volume and attach it to a path in the container:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker volume create volume-mariadb
</span></span><span style=display:flex><span>docker run --name mariadb-container-with-external-volume -v volume-mariadb:/var/lib/mysql -e <span style=color:#000>MARIADB_ROOT_PASSWORD</span><span style=color:#ce5c00;font-weight:700>=</span>my-secret-pw -d mariadb
</span></span></code></pre></div><p>In case you are wondering where your data ends up you can inspect the volume with:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker volume inspect volume-mariadb
</span></span></code></pre></div><p>Okay, now create a new user in the MariaDB container:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker <span style=color:#204a87>exec</span> -it mariadb-container-with-external-volume mariadb -uroot -pmy-secret-pw
</span></span></code></pre></div><p>Inside the mariadb-client execute some SQL commands to grant user peter read permissions to the user table:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>use mysql
</span></span><span style=display:flex><span>CREATE USER <span style=color:#4e9a06>&#39;peter&#39;</span>@<span style=color:#4e9a06>&#39;%&#39;</span> IDENTIFIED BY <span style=color:#4e9a06>&#39;venkman&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span><span style=display:flex><span>GRANT SELECT ON mysql.user TO <span style=color:#4e9a06>&#39;peter&#39;</span>@<span style=color:#4e9a06>&#39;%&#39;</span><span style=color:#000;font-weight:700>;</span>
</span></span></code></pre></div><p>Once all steps are completed quit the mysql session which also will exit the container:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>exit</span>
</span></span></code></pre></div><p>We have added a new user to our DB and persistet the data through the use of volumes!</p><div class="text-muted mt-5 pt-3"><div class=row><div class=col-sm><a href=../../../../../docs/container-basics/01-basics/01/_images/ data-toggle=tooltip title="1.1 Images"><i class="fa fa-arrow-circle-left"></i> Previous</a></div><div class="col-sm text-right"><a href=../../../../../docs/container-basics/01-basics/01/_frontend/ data-toggle=tooltip title="1.3 Frontend">Next <i class="fa fa-arrow-circle-right"></i></a></div></div></div><div class=td-page-meta__lastmod>Last modified October 22, 2024: <a href=https://github.com/verysonglaa/k8s-security-training-website/commit/1c189ea1ef799657ba169f3939abe66cae4ecfaf>improvment on labs (1c189ea)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/verysonglaa/k8s-security-training-website aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>songlaa gmbh</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=../../../../../js/main.min.37d14e870feb76f0f7a2a2422bae231efb0186c477999a4ab9ca7e9924ced592.js integrity="sha256-N9FOhw/rdvD3oqJCK64jHvsBhsR3mZpKucp+mSTO1ZI=" crossorigin=anonymous></script><script defer src=../../../../../js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=../../../../../js/tabpane-persist.js></script><script src=../../../../../js/site.min.1b86eee028c038e3c091bb0e4a5f11d864071cfddfac37a5b7d7dc4b7af9bd0a.js integrity="sha256-G4bu4CjAOOPAkbsOSl8R2GQHHP3frDelt9fcS3r5vQo=" crossorigin=anonymous></script></body></html>